# Инструкция по разработке мобильного приложения

Короткая схема, как устроена разработка и доставляются изменения.

## 1) Где правим код
- Исходники мобильного приложения лежат в `packages/mobile`.
- Основные экраны и компоненты: `packages/mobile/src`.

## 2) Локальный запуск
Запуск Metro (JS-код, стили, логика):
```
npm run start:mobile
```

### Expo Go
- Подходит только для чистого JS.
- Нативные библиотеки (например Skia) **не работают**.

### Dev Client (для нативных модулей)
- Нужен, если добавлялись нативные зависимости.
- Требуется сборка APK (см. раздел «Сборка»).

## 3) Переменные окружения
API URL задаётся через `EXPO_PUBLIC_API_URL`.

Файл с переменными:
- `packages/mobile/.env`

Пример:
```
EXPO_PUBLIC_API_URL=https://your-domain.com/api
```

Для EAS build эти переменные нужно также добавить в EAS Environment Variables
(профиль `preview` или другой).

## 4) Сборка APK (Android, dev client)
Сборка через EAS (облачная):
```
cd packages/mobile
eas build -p android --profile preview
```

После завершения сборки EAS выдаст ссылку на APK.
APK можно установить на телефон и использовать как dev client.

## 5) Обновления приложения
Есть 2 типа обновлений:

1) **JS-обновления (OTA)**
- Можно доставлять без пересборки APK через EAS Update.
- Подходит для изменений экранов/логики/стилей.

2) **Нативные изменения**
- Требуют новой сборки APK.
- Примеры: подключение Skia, новых нативных модулей.

## 6) Связка с сервером
- Git push не обновляет сервер автоматически (если нет CI/CD).
- Сервер обновляется отдельно (pull + перезапуск сервиса).
- Мобильное приложение получает API URL из `.env` или EAS env vars.

## Быстрый чек-лист
- Поменял только JS → OTA update.
- Добавил нативную либу → пересборка APK.
- Проверить `EXPO_PUBLIC_API_URL` перед сборкой.
